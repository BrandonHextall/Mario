<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enemy Physics</title>
    <style>canvas {border:1px solid;position:fixed;left:10}</style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>
<body>
    <!-- Make a 2048 game -->
    <!-- Make Tetris game -->
    <!--
        Permanent comments (for guidance and descriptions of code) don't have whitespace after //, as well as starting with a capital letter
        Temporary comments (telling me what I need to make) has a whitespace after //, as well as starting with no capital
        commented code (whether temporarily for debugging purposes or failed code or otherwise) is the same as temporary. distinguishing between the two should be easy enough
        
        When making classes, have a list or something similar for the assets and colour schemes etc so that they dont have to be hardcoded
        green enemies have the same colour palette underwater and in castle
        fire assets come under red enemy class
        When making classes for objects, create an attribute defining the location of the colour palette for that object
        
        When rendering tiles, will need to clear a rectangle of the tilemap, draw the background over it again,
        then draw the asset
        This is because in the original game, when tiles overlap parts of the initial asset get destroyed where
        the new asset as been drawn and do not overlap.
        I assume coins and items do not replace other sprites

        When spawning enemies, give the enemy a spawning block (indicated on the level maps) and when that pillar of tiles is rendered, activate the enemy

        game screen ratio is 4:3.
        This might help with side scrolling stuff: https://gamedev.stackexchange.com/questions/19104/how-do-i-implement-side-scrolling-in-a-javascript-platformer

        do everything without tilesize and scaling cuz when thats done, everything will scale easily

        when picking up a coin, check if coins = 100. if yes reset to 0 and give extra life

        when mario headbutts a tile, change the y-velocity to an immediate negative value or immediately invert the y-velocity

        NEXT TASK:
            Ensure enemies have basic physics (or necessary physics, if applicable) before moving forward

            Make sprites be able to be drawn in reverse depending on direction facing:
                have 2 version of each sprite saved in preRender function
                when changing asset, check which side entity is facing
                change sprite depending on direction

            ENEMIES MOTHERFUCKA!
            Make enemies move before doing anything else.
                Collision and movement is most important
                Ensure basic tile collision and movement is working for each entity
                Figure out the other shit later

            I have reason to believe that Goombas act the same way as a mushroom in terms of their physics and when hit from underneath a tile

            Entity positioning task:
                All entities are 1 pixel into tiles so EITHER :
                    Give tiles a hitbox
                        OR
                    draw entities 1 pixel into tiles
                Make entities render after tiles so they appear on top
                Find a way to draw mario when moving left (and spawn fireballs to the left) (probably check what direction mario is moving and if left, start from the end of the sprite instead of the left)

            Fix mario skid-turning (too slow)

            Create Star powerup
            
            make mario crouch:
                x-acceleration = 0 while crouched
                change hitbox and sprite
                can still jump
                if mario small, cannot crouch, no attributes affected by down button
            
            Change anything that has tile collision and make it all a single loop of tiles being checked so that every tile is only checked once for everything at the same time
        
        Stuff that needs testing when level designing:
            accuracy of mario move speeds (time it takes to reach a certain point - test against Mesen emulation)
            mario moves too fast when accelerating in air from low speed. give him a max speed in air if his speed is low

        NOTE: some 3-key combinations do not work (eg. a s w, d s w) which could restrict certain actions (put a disclaimer up for that)
    -->
    <h2 id="debug"></h2>
    <canvas id="canvas"></canvas>
    <script type="module" src="./js/main.mjs"></script>
</body>
</html>